‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                      BondsPortfolioAnalysisPipeline                 ‚îÇ
‚îÇ                         (–û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω–≤–µ–π–µ—Ä)                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 1. BondsDataLoader     ‚Üí –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ Excel                   ‚îÇ
‚îÇ 2. BondsAnalyzer       ‚Üí –†–∞—Å—á–µ—Ç –º–µ—Ç—Ä–∏–∫ –ø–æ –∫–∞–∂–¥–æ–π –æ–±–ª–∏–≥–∞—Ü–∏–∏          ‚îÇ
‚îÇ 3. BondScorer          ‚Üí –°–∫–æ—Ä–∏–Ω–≥ –∏ —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±–ª–∏–≥–∞—Ü–∏–π           ‚îÇ
‚îÇ 4. BondsPortfolioOptimizer ‚Üí –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è                   ‚îÇ
‚îÇ 5. BondsPortfolioVisualizer ‚Üí –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤              ‚îÇ
‚îÇ 6. BondsExcelReportGenerator ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Excel –æ—Ç—á–µ—Ç–∞               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üì• 1. BondsDataLoader ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:

–ß–∏—Ç–∞–µ—Ç Excel-—Ñ–∞–π–ª —Å –¥–∞–Ω–Ω—ã–º–∏ –æ–± –æ–±–ª–∏–≥–∞—Ü–∏—è—Ö

–ü—Ä–∏–≤–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫ –µ–¥–∏–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É

–§–∏–ª—å—Ç—Ä—É–µ—Ç —Ç–æ–ª—å–∫–æ –±—É–¥—É—â–∏–µ –¥–∞—Ç—ã –ø–æ–≥–∞—à–µ–Ω–∏—è

–õ–æ–≥–∏–∫–∞:

python
df = pd.read_excel(file_path)
# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤—ã–≤–∞–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ –≤ –ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è
df.columns = ["ticker", "name", "sector", "currency", "maturity_date", ...]

# –ó–∞–ø–æ–ª–Ω—è–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
df["sector"] = df["sector"].fillna("other")
df["currency"] = df["currency"].fillna("rub")

# –û—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ –æ–±–ª–∏–≥–∞—Ü–∏–∏ —Å –±—É–¥—É—â–µ–π –¥–∞—Ç–æ–π –ø–æ–≥–∞—à–µ–Ω–∏—è
df = df[df["maturity_date"] > today]
–ü–æ—á–µ–º—É —Ç–∞–∫: –û–±–ª–∏–≥–∞—Ü–∏–∏ —Å –ø—Ä–æ—à–µ–¥—à–µ–π –¥–∞—Ç–æ–π –ø–æ–≥–∞—à–µ–Ω–∏—è —É–∂–µ –Ω–µ —Ç–æ—Ä–≥—É—é—Ç—Å—è.

üìê 2. Bond ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–ª–∏–≥–∞—Ü–∏–∏
–ö–∞–∂–¥–∞—è –æ–±–ª–∏–≥–∞—Ü–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –∫–∞–∫ dataclass —Å –º–Ω–æ–∂–µ—Å—Ç–≤–æ–º –ø–æ–ª–µ–π:

python
@dataclass
class Bond:
    ticker: str                # –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä
    name: str                   # –ù–∞–∑–≤–∞–Ω–∏–µ —ç–º–∏—Ç–µ–Ω—Ç–∞
    sector: str                 # –°–µ–∫—Ç–æ—Ä —ç–∫–æ–Ω–æ–º–∏–∫–∏
    currency: str               # –í–∞–ª—é—Ç–∞ (RUB, CNY, USD, EUR)
    maturity_date: date         # –î–∞—Ç–∞ –ø–æ–≥–∞—à–µ–Ω–∏—è
    nominal: float               # –ù–æ–º–∏–Ω–∞–ª
    risk_level: int              # –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ (0-3)
    floating_coupon: bool        # –ü–ª–∞–≤–∞—é—â–∏–π –∫—É–ø–æ–Ω?
    coupon_rate: float            # –°—Ç–∞–≤–∫–∞ –∫—É–ø–æ–Ω–∞ (%)

–†–∞—Å—á–µ—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–º–µ—Ç–æ–¥ calculate_metrics)
–ü–∞—Ä–∞–º–µ—Ç—Ä	–§–æ—Ä–º—É–ª–∞	–°–º—ã—Å–ª
years_to_maturity	days/365	–õ–µ—Ç –¥–æ –ø–æ–≥–∞—à–µ–Ω–∏—è
current_yield	coupon_rate/100	–¢–µ–∫—É—â–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
yield_to_maturity	–î–ª—è —Ñ–ª–æ–∞—Ç–µ—Ä–æ–≤: base_rate + spread	–î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –∫ –ø–æ–≥–∞—à–µ–Ω–∏—é
modified_duration	years/(1+yield)	–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ü–µ–Ω—ã –∫ —Å—Ç–∞–≤–∫–µ
convexity	years¬≤/100	–ö—Ä–∏–≤–∏–∑–Ω–∞ –∫—Ä–∏–≤–æ–π —Ü–µ–Ω–∞-–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
credit_spread	ytm - risk_free_rate	–ü—Ä–µ–º–∏—è –∑–∞ —Ä–∏—Å–∫
liquidity_score	min(nominal/1000,1)*(1-risk*0.2)	–û—Ü–µ–Ω–∫–∞ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏
real_yield	current_yield - inflation	–†–µ–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å

üìä 3. BondsAnalyzer ‚Äî –∞–Ω–∞–ª–∏–∑ –æ–±–ª–∏–≥–∞—Ü–∏–π
3.1 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º —Ä–∏—Å–∫–∞
–ì—Ä—É–ø–ø–∏—Ä—É–µ—Ç –æ–±–ª–∏–≥–∞—Ü–∏–∏ –ø–æ risk_level (0,1,2,3) –∏ —Å—á–∏—Ç–∞–µ—Ç:

–°—Ä–µ–¥–Ω—é—é, –º–∏–Ω, –º–∞–∫—Å –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å

–°—Ä–µ–¥–Ω—é—é –¥—é—Ä–∞—Ü–∏—é

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±–ª–∏–≥–∞—Ü–∏–π

–†–µ–∑—É–ª—å—Ç–∞—Ç:

text
risk_level  Avg Yield  Min Yield  Max Yield  Count
0              13.06       0.01      25.00     60
1              13.39       0.00      25.25    660
2              16.28       0.00      29.50    381
3              20.83       0.00      33.00    375
–í—ã–≤–æ–¥: –†–∏—Å–∫-—É—Ä–æ–≤–µ–Ω—å 3 –¥–∞–µ—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (21%), –Ω–æ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–±—Ä–æ—Å.

3.2 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–∞–ª—é—Ç–∞–º
–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –≤–∞–ª—é—Ç–∞–º:

text
currency  Avg Yield  Count  Total Nominal
cny           7.01     22       20200
rub          16.25   1440    55131018
usd           5.87     13       13000
–í—ã–≤–æ–¥: –†—É–±–ª–µ–≤—ã–µ –æ–±–ª–∏–≥–∞—Ü–∏–∏ ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π —Ä—ã–Ω–æ–∫ (1440 —à—Ç.), –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å 16.25%.

 4. BondScorer ‚Äî —Å–∫–æ—Ä–∏–Ω–≥ –æ–±–ª–∏–≥–∞—Ü–∏–π
–≠—Ç–æ –∫–ª—é—á–µ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –æ—Ç–±–æ—Ä–∞ –ª—É—á—à–∏—Ö –æ–±–ª–∏–≥–∞—Ü–∏–π. –ö–∞–∂–¥–∞—è –æ–±–ª–∏–≥–∞—Ü–∏—è –ø–æ–ª—É—á–∞–µ—Ç –æ—Ü–µ–Ω–∫—É –ø–æ 6 –∫—Ä–∏—Ç–µ—Ä–∏—è–º.

–í–µ—Å–∞ –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ (–∏–∑ –∫–æ–Ω—Å—Ç–∞–Ω—Ç):
python
SCORING_WEIGHTS = {
    'yield_score': 0.30,     # –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å (30%)
    'risk_score': 0.25,      # –†–∏—Å–∫ (25%)
    'liquidity_score': 0.15, # –õ–∏–∫–≤–∏–¥–Ω–æ—Å—Ç—å (15%)
    'duration_score': 0.10,  # –î—é—Ä–∞—Ü–∏—è (10%)
    'sector_score': 0.10,    # –°–µ–∫—Ç–æ—Ä (10%)
    'currency_score': 0.10   # –í–∞–ª—é—Ç–∞ (10%)
}
–ö–∞–∫ —Å—á–∏—Ç–∞—é—Ç—Å—è —Å–∫–æ—Ä–∏–Ω–≥–æ–≤—ã–µ –±–∞–ª–ª—ã:
1. Yield Score (—á–µ–º –≤—ã—à–µ –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, —Ç–µ–º –ª—É—á—à–µ)
python
# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤—Å–µ—Ö –æ–±–ª–∏–≥–∞—Ü–∏–π
bond.yield_score = (bond.current_yield - min_yield) / (max_yield - min_yield)
2. Risk Score (—á–µ–º –Ω–∏–∂–µ —Ä–∏—Å–∫, —Ç–µ–º –ª—É—á—à–µ)
python
bond.risk_score = 1 - (bond.risk_level / 3)  # risk_level 0 ‚Üí 1.0, risk_level 3 ‚Üí 0.0
3. Liquidity Score (—á–µ–º –≤—ã—à–µ –Ω–æ–º–∏–Ω–∞–ª –∏ –Ω–∏–∂–µ —Ä–∏—Å–∫, —Ç–µ–º –ª–∏–∫–≤–∏–¥–Ω–µ–µ)
python
bond.liquidity_score_norm = min(nominal/1000, 1) * (1 - risk_level * 0.2)
4. Duration Score (—á–µ–º –±–ª–∏–∂–µ –∫ —Ü–µ–ª–µ–≤–æ–π –¥—é—Ä–∞—Ü–∏–∏, —Ç–µ–º –ª—É—á—à–µ)
python
target_dur = OPTIMIZATION_PARAMS["target_duration"]  # 3.5 –≥–æ–¥–∞
deviation = abs(bond.modified_duration - target_dur)
bond.duration_score = 1 - min(deviation / target_dur, 1)
5. Sector Score (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ —Å–µ–∫—Ç–æ—Ä–∞ –ø–æ–ª—É—á–∞—é—Ç –≤—ã—à–µ –±–∞–ª–ª)
python
sector_weight = SECTORS.get(bond.sector, {}).get("max_weight", 0.1)
bond.sector_score = min(sector_weight * 5, 1)  # max_weight 0.2 ‚Üí score 1.0
6. Currency Score (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –ø–æ –≤–∞–ª—é—Ç–µ)
python
min_yield = CURRENCY_PARAMS[bond.currency]["min_yield"]
if bond.current_yield >= min_yield:
    bond.currency_score = 1
else:
    bond.currency_score = bond.current_yield / min_yield
–ò—Ç–æ–≥–æ–≤—ã–π score:
python
bond.total_score = sum(weight * score for weight, score in zip(weights, scores))
–ü–æ—Å–ª–µ —Å–∫–æ—Ä–∏–Ω–≥–∞ –±–µ—Ä–µ–º —Ç–æ–ø-50 –æ–±–ª–∏–≥–∞—Ü–∏–π –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏.

üìà 5. BondsPortfolioOptimizer ‚Äî –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è
5.1 –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Ä—Ç—Ñ–µ–ª—è
python
def portfolio_statistics(self, weights):
    portfolio_yield = sum(weight * bond.current_yield)
    portfolio_duration = sum(weight * bond.modified_duration)
    portfolio_risk = sum(weight * bond.risk_level)
    
    # –ò–Ω–¥–µ–∫—Å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –•–µ—Ä—Ñ–∏–Ω–¥–∞–ª—è-–•–∏—Ä—à–º–∞–Ω–∞
    hhi = sum(weight¬≤)
    
    # –û—Ü–µ–Ω–∫–∞ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (1 = –∏–¥–µ–∞–ª—å–Ω–æ –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω)
    diversification = 1 - (hhi - 1/n) / (1 - 1/n)
5.2 –¶–µ–ª–µ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è (—á—Ç–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º)
python
def objective_function(self, weights):
    stats = self.portfolio_statistics(weights)
    
    # –ú–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ–º –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å
    yield_score = stats["yield"] * 100
    
    # –ú–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ–º —Ä–∏—Å–∫
    risk_penalty = stats["risk_score"] * 0.01
    
    # –®—Ç—Ä–∞—Ñ –∑–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –æ—Ç —Ü–µ–ª–µ–≤–æ–π –¥—é—Ä–∞—Ü–∏–∏
    duration_penalty = abs(stats["duration"] - 3.5) * 0.005
    
    # –®—Ç—Ä–∞—Ñ –∑–∞ –ø–ª–æ—Ö—É—é –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—é
    div_penalty = (1 - stats["diversification"]) * 0.02
    
    # –®—Ç—Ä–∞—Ñ –∑–∞ —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ/–º–Ω–æ–≥–æ –æ–±–ª–∏–≥–∞—Ü–∏–π
    n_bonds_penalty = max(0, stats["n_bonds"] - 30) * 0.005
    n_bonds_penalty += max(0, 15 - stats["n_bonds"]) * 0.01
    
    return -(yield_score - risk_penalty - duration_penalty - div_penalty - n_bonds_penalty)
–ß—Ç–æ –º—ã –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ–º (–Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –º–∞–∫—Å–∏–º–∏–∑–∏—Ä—É–µ–º –æ—Ç—Ä–∏—Ü–∞–Ω–∏–µ):

text
Score = –î–æ—Ö–æ–¥–Ω–æ—Å—Ç—å√ó100 
        - –†–∏—Å–∫√ó0.01 
        - |–î—é—Ä–∞—Ü–∏—è - 3.5|√ó0.005 
        - (1 - –î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è)√ó0.02 
        - –®—Ç—Ä–∞—Ñ –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
5.3 –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (constraints)
python
def check_constraints(self, weights):
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å –Ω–µ –Ω–∏–∂–µ 12%
    if stats["yield"] < 0.12: return False
    
    # –ù–∏ –æ–¥–Ω–∞ –æ–±–ª–∏–≥–∞—Ü–∏—è –Ω–µ –±–æ–ª—å—à–µ 15%
    if max(weights) > 0.15: return False
    
    # –ù–∏ –æ–¥–∏–Ω —ç–º–∏—Ç–µ–Ω—Ç –Ω–µ –±–æ–ª—å—à–µ 20%
    issuer_weights = –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –ø–µ—Ä–≤–æ–º—É —Å–ª–æ–≤—É –Ω–∞–∑–≤–∞–Ω–∏—è
    if max(issuer_weights.values()) > 0.20: return False
    
    return True
5.4 –ú–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ ‚Äî –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è
–ü–æ—á–µ–º—É –∏–º–µ–Ω–Ω–æ differential_evolution, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ–π minimize?

–ú–µ—Ç–æ–¥	–ü–ª—é—Å—ã	–ú–∏–Ω—É—Å—ã
SLSQP (–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π)	–ë—ã—Å—Ç—Ä—ã–π	–ù–∞—Ö–æ–¥–∏—Ç –ª–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º
Differential Evolution	–ù–∞—Ö–æ–¥–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º	–ú–µ–¥–ª–µ–Ω–Ω–µ–µ
–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è:

text
1. –°–æ–∑–¥–∞–µ–º –ø–æ–ø—É–ª—è—Ü–∏—é —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ—Ä—Ç—Ñ–µ–ª–µ–π (popsize=15)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Ä—Ç—Ñ–µ–ª—è:
   - –í—ã–±–∏—Ä–∞–µ–º 3 —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ—Ä—Ç—Ñ–µ–ª—è
   - –°–æ–∑–¥–∞–µ–º "–º—É—Ç–∞–Ω—Ç–∞" = –ø–æ—Ä—Ç—Ñ–µ–ª—å1 + F*(–ø–æ—Ä—Ç—Ñ–µ–ª—å2 - –ø–æ—Ä—Ç—Ñ–µ–ª—å3)
   - –°–∫—Ä–µ—â–∏–≤–∞–µ–º –º—É—Ç–∞–Ω—Ç–∞ —Å —Ç–µ–∫—É—â–∏–º –ø–æ—Ä—Ç—Ñ–µ–ª–µ–º
   - –ï—Å–ª–∏ –ø–æ—Ç–æ–º–æ–∫ –ª—É—á—à–µ ‚Äî –∑–∞–º–µ–Ω—è–µ–º
3. –ü–æ–≤—Ç–æ—Ä—è–µ–º maxiter=1000 —Ä–∞–∑
4. –°—Ö–æ–¥–∏–º—Å—è –∫ –≥–ª–æ–±–∞–ª—å–Ω–æ–º—É –æ–ø—Ç–∏–º—É–º—É
–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:

popsize=15 ‚Äî —Ä–∞–∑–º–µ—Ä –ø–æ–ø—É–ª—è—Ü–∏–∏

maxiter=1000 ‚Äî –º–∞–∫—Å–∏–º—É–º –∏—Ç–µ—Ä–∞—Ü–∏–π

tol=1e-6 ‚Äî —Ç–æ—á–Ω–æ—Å—Ç—å

seed=42 ‚Äî –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å

üé® 6. BondsPortfolioVisualizer ‚Äî –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
6.1 –ö—Ä–∏–≤–∞—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ (Yield Curve)
–¢–æ—á–µ—á–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫: –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å vs –ª–µ—Ç –¥–æ –ø–æ–≥–∞—à–µ–Ω–∏—è. –†–∞–∑–Ω—ã–µ —Ü–≤–µ—Ç–∞ ‚Äî —É—Ä–æ–≤–Ω–∏ —Ä–∏—Å–∫–∞.

–ö—Ä–∞—Å–Ω–∞—è –ª–∏–Ω–∏—è ‚Äî –±–µ–∑—Ä–∏—Å–∫–æ–≤–∞—è —Å—Ç–∞–≤–∫–∞ (16%)

–ü–æ–∑–≤–æ–ª—è–µ—Ç —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫–∏–µ –æ–±–ª–∏–≥–∞—Ü–∏–∏ –¥–∞—é—Ç –∞–Ω–æ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å

6.2 –°–µ–∫—Ç–æ—Ä–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî –∫–∞–∫–æ–π —Å–µ–∫—Ç–æ—Ä —Å–∫–æ–ª—å–∫–æ –≤–µ—Å–∏—Ç –≤ –ø–æ—Ä—Ç—Ñ–µ–ª–µ.

6.3 –í–∞–ª—é—Ç–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
–ö—Ä—É–≥–æ–≤–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî RUB, CNY, USD, EUR.

6.4 –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–≥–∞—à–µ–Ω–∏–π (Maturity Profile)
–°—Ç–æ–ª–±—á–∞—Ç–∞—è –¥–∏–∞–≥—Ä–∞–º–º–∞ ‚Äî –≤–µ—Å –∫–∞–∂–¥–æ–π –æ–±–ª–∏–≥–∞—Ü–∏–∏ –∏ —Å—Ä–æ–∫ –¥–æ –ø–æ–≥–∞—à–µ–Ω–∏—è.

6.5 –ê–Ω–∞–ª–∏–∑ —Ä–∏—Å–∫–æ–≤ (Risk Analysis)
–î–≤–µ –¥–∏–∞–≥—Ä–∞–º–º—ã:

–°—Ç–æ–ª–±—Ü—ã: –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, –¥—é—Ä–∞—Ü–∏—è, –¥–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è, —Ä–∏—Å–∫

–ö—Ä—É–≥–æ–≤–∞—è: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞ –ø–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º (–¥–æ—Ö–æ–¥–Ω–æ—Å—Ç—å, –¥—é—Ä–∞—Ü–∏—è, –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è, –∫—Ä–µ–¥–∏—Ç)

üìë 7. BondsExcelReportGenerator ‚Äî Excel –æ—Ç—á–µ—Ç
–°–æ–∑–¥–∞–µ—Ç Excel-—Ñ–∞–π–ª —Å 7 –ª–∏—Å—Ç–∞–º–∏:

Portfolio Summary ‚Äî —Å–≤–æ–¥–∫–∞ –ø–æ –ø–æ—Ä—Ç—Ñ–µ–ª—é

Portfolio Holdings ‚Äî –¥–µ—Ç–∞–ª—å–Ω—ã–π —Å–æ—Å—Ç–∞–≤

Risk Statistics ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É—Ä–æ–≤–Ω—è–º —Ä–∏—Å–∫–∞

Currency Statistics ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–∞–ª—é—Ç–∞–º

All Bonds ‚Äî –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å–æ —Å–∫–æ—Ä–∏–Ω–≥–æ–≤—ã–º–∏ –æ—Ü–µ–Ω–∫–∞–º–∏

Risk Portfolios ‚Äî –ø–æ—Ä—Ç—Ñ–µ–ª–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π —Ä–∏—Å–∫–∞

Optimization Params ‚Äî –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

üîÑ 8. BondsPortfolioAnalysisPipeline ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω–≤–µ–π–µ—Ä
–û–±—ä–µ–¥–∏–Ω—è–µ—Ç –≤—Å–µ —à–∞–≥–∏ –≤ –µ–¥–∏–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å:

python
def run(self, file_path):
    1. –ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
    2. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏
    3. –í—ã–≤–µ—Å—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
    4. –û—Ç–æ–±—Ä–∞—Ç—å —Ç–æ–ø-50 –ø–æ —Å–∫–æ—Ä–∏–Ω–≥—É
    5. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫—Ä–∏–≤—É—é –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏
    6. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—å
    7. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª–∏ –ø–æ —É—Ä–æ–≤–Ω—è–º —Ä–∏—Å–∫–∞
    8. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
    9. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å Excel
üß† –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
–ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–¥–∞—á–∏:
‚Äã![alt text](image.png)
  ‚Äî –∏–Ω–¥–µ–∫—Å –•–µ—Ä—Ñ–∏–Ω–¥–∞–ª—è-–•–∏—Ä—à–º–∞–Ω–∞

üí° –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã –∏–∑ –∫–æ–¥–∞
–°–∫–æ—Ä–∏–Ω–≥ ‚Äî –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å –æ–±–ª–∏–≥–∞—Ü–∏–∏ –ø–æ –º–Ω–æ–∂–µ—Å—Ç–≤—É –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤

–î–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è —ç–≤–æ–ª—é—Ü–∏—è ‚Äî –Ω–∞—Ö–æ–¥–∏—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–π –æ–ø—Ç–∏–º—É–º –≤ —Å–ª–æ–∂–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ

–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è ‚Äî —É—á–∏—Ç—ã–≤–∞—é—Ç —Ä–µ–∞–ª—å–Ω—ã–µ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–æ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ (–Ω–µ –±–æ–ª—å—à–µ 15% –≤ –æ–¥–Ω—É –±—É–º–∞–≥—É)

–î–∏–≤–µ—Ä—Å–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–∞ –≤ —Ü–µ–ª–µ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —á–µ—Ä–µ–∑ HHI

–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è ‚Äî –ø–æ–º–æ–≥–∞–µ—Ç –±—ã—Å—Ç—Ä–æ –ø–æ–Ω—è—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø–æ—Ä—Ç—Ñ–µ–ª—è

